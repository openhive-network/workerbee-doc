<style>
  /* Custom CSS: https://github.com/retypeapp/retype/discussions/81#discussioncomment-2473238 */

  :root {
    /* oklch values for Hive theme - https://oklch.com/ */
    --hive-lightness:       0.58;
    --hive-lightness-hover: 0.48;
    --hive-chroma:          0.2;

    --hive-primary:         var(--hive-lightness)       var(--hive-chroma) 24;
    --hive-primary-hover:   var(--hive-lightness-hover) var(--hive-chroma) 30;
    --hive-primary-text:    var(--hive-lightness)       var(--hive-chroma) 15;

    --hive-callout-primary: var(--hive-lightness) 0.044 265;
  }

  .text-base-500, .text-badge-primary-text, button {
    color: oklch(var(--hive-primary-text)) !important;
  }

  .hover\:border-base-border-hover:hover {
    border-color: oklch(var(--hive-primary-hover)) !important;
  }
  .border-badge-primary-border {
    border-color: oklch(var(--hive-primary)  / .2) !important;
  }
  .border-gray-400 {
    border-color: oklch(var(--hive-primary-hover) / .9) !important;
  }

  .bg-gray-100 {
    background-color: oklch(var(--hive-primary-hover) / .05) !important;
  }
  .bg-gray-200, .hover\:bg-nav-item-bg-hover:hover {
    background-color: oklch(var(--hive-primary-hover) / .1) !important;
  }

  .text-nav-item-text-active, .bg-badge-primary, .bg-base-item-bg:hover, .hover\:bg-gray-200:hover, .hover\:bg-base-item-bg-hover:hover,
  .bg-base-item-bg-hover, button.scheme-menu-item:hover, .scheme-menu-item-active {
    background-color: oklch(var(--hive-primary) / .1) !important;
  }

  a.text-toc-text-active, a.hover\:text-toc-text-hover:hover, .text-branding-label-text, .text-nav-item-text-active,
  nav a, footer a, a.header-anchor-trigger, .retype-markdown a {
    color: oklch(var(--hive-primary)) !important;
  }

  .hover\:bg-nav-item-bg-hover:hover > a > span, .dark button:hover,
  button:hover, nav a:hover, footer a:hover, .retype-markdown a:hover,
  .retype-markdown div > h1 > .header-anchor-trigger:hover, .retype-markdown div > h2 > .header-anchor-trigger:hover,
  .retype-markdown div > h3 > .header-anchor-trigger:hover, .retype-markdown div > h4 > .header-anchor-trigger:hover,
  .retype-markdown div > h5 > .header-anchor-trigger:hover, .retype-markdown div > h6 > .header-anchor-trigger:hover {
    color: oklch(var(--hive-primary-hover)) !important;
  }

  .border-tab-border-active {
    border-color: oklch(var(--hive-primary)) !important;
  }

  .bg-toc-border-active, .bg-nav-item-border-active {
    background-color: oklch(var(--hive-primary)) !important;
  }

  .ring-1 {
    box-shadow: 0 0 0 1px oklch(var(--hive-primary)) !important;
  }

  /* Override default callout colors to match secondary one - this is to avoid confusion with error callouts */
  .text-callout-primary {
    color: oklch(var(--hive-callout-primary)) !important;
  }
  .bg-callout-primary {
    background-color: oklch(var(--hive-callout-primary)) !important;
  }
</style>
<script>
  // This code is responsible for persisting the selected programming language
  {
    const languages = {
      'javascript': [],
      'python': []
    };
    const languageKeys = Object.keys(languages);

    const originalHistoryPush = history.pushState;
    history.pushState = function(...args) {
      const url = new URL(args[2]);
      if (url.host !== window.location.host)
        return originalHistoryPush.apply(this, args); // Do not interfere with external links

      const lang = window.localStorage.getItem('lang');
      if (lang) {
        // We could use the official Retype supported syntax, but it is not persistant over multiple websites,
        // We also cannot link to a specific section when using the hash syntax and when used, it scrolls down.
        // We can uncomment the following code when Retype makes it work better or adds some official support for persistant state tabs.
        // const hash = url.hash.slice(1); if (!hash || languageKeys.includes(hash)) url.hash = `#${lang}`; else
        // For now we have to use the query syntax:
        url.searchParams.set('lang', lang);
        args[2] = url.toString();
      }
      return originalHistoryPush.apply(this, args);
    };

    let previousLang;

    window.addEventListener('DOMContentLoaded', () => {
      // Also apply the current language periodically.
      const applyLanguage = () => {
        const lang = window.localStorage.getItem('lang');
        if (!lang)
          return;
        languages[lang].forEach(el => {
          el.click();
        });
      }
      // Tab items are generated on the client side based on the templates, so we need to wait for them to be available.
      // Also the entire DOM of the document.body can be replaced, invalidating all of our components, so we have to re-gather them periodically.
      const gatherNodes = () => {
        Object.keys(languages).forEach(async lang => {
          let langNodes;
          while(true) {
            langNodes = document.querySelectorAll(`div#${lang} > a`);
            if (langNodes.length > 0)
              break;

            await new Promise(resolve => setTimeout(resolve, 50));
          }

          if (langNodes[0] === languages[lang][0])
            return; // Already applied on click event

          languages[lang] = langNodes;

          languages[lang].forEach(el => {
            el.addEventListener("click", event => {
              if (!event.isTrusted) return; // Ignore non-user-initiated events
              window.localStorage.setItem('lang', lang);
              applyLanguage();
              // Change the user location for the SEO - load other languages snippets and documentation
              window.history.pushState(null, '', window.location.href);
            });
          });
          applyLanguage();
        });
      };
      setInterval(gatherNodes, 200);
      setInterval(applyLanguage, 1000);
      const url = new URL(window.location.href);
      const lang = url.searchParams.get('lang');
      if (lang) // On hard refresh, or on first visit, when lang in query provided - apply this setting
        window.localStorage.setItem('lang', lang);
    });
  }
</script>
